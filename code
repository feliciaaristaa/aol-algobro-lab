#include <stdio.h>
#include <string.h>

typedef struct {
    char nama[50];
    char genre[30];
} Artist;

typedef enum {
    ROAST_NORMIE,
    ROAST_TRYHARD,
    ROAST_DELUSIONAL,
    ROAST_EDGY,
    ROAST_PLAYER,
    ROAST_STARBOY,
    ROAST_PERFORMATIVE,
    ROAST_SKENA,
    ROAST_SAD,
    ROAST_COUNT
} RoastType;

typedef enum {
    GENRE_POP,
    GENRE_RAP,
    GENRE_ROCK,
    GENRE_METAL,
    GENRE_EDM,
    GENRE_JAZZ,
    GENRE_INDIE,
    GENRE_COUNT
} GenreType;

typedef struct {
    int point[ROAST_COUNT];
} RoastScore;




void inputDanSimpan() {
    FILE *fp;
    Artist a;
    int pilihanGenre;
    int jumlah;
    int i;

    fp = fopen("artist.dat", "ab");
    if (fp == NULL) {
        printf("Gagal membuka file!\n");
        return;
    }

    printf("\nMasukkan jumlah artist yang ingin diinput: ");
    scanf("%d", &jumlah);

    for (i = 0; i < jumlah; i++) {
        printf("\n=== Artist ke-%d ===\n", i + 1);

        printf("Nama artist: ");
        scanf(" %[^\n]", a.nama);

        printf("\nPilih genre utama artist:\n");
	printf("1. Pop\n");
	printf("2. Rap / Hip-Hop\n");
	printf("3. Rock / Punk\n");
	printf("4. Metal / Goth\n");
	printf("5. EDM / Electronic\n");
	printf("6. Jazz / Blues\n");
	printf("7. Indie / Alternative\n");
	printf("8. RnB / Soul\n");
	printf("9. OST / Soundtrack\n");
	printf("10. Lainnya\n");
	printf("Pilihan (1-10): ");

        scanf("%d", &pilihanGenre);

        switch (pilihanGenre) {
            case 1: strcpy(a.genre, "Pop"); break;
            case 2: strcpy(a.genre, "Rap"); break;
            case 3: strcpy(a.genre, "Rock"); break;
            case 4: strcpy(a.genre, "Metal"); break;
            case 5: strcpy(a.genre, "EDM"); break;
            case 6: strcpy(a.genre, "Jazz"); break;
            case 7: strcpy(a.genre, "Indie"); break;
            case 8: strcpy(a.genre, "RnB"); break;
            case 9: strcpy(a.genre, "OST"); break;
            case 10: strcpy(a.genre, "Lainnya"); break;

            default:
                printf("Genre tidak valid, ulangi input artist ini.\n");
                i--;
                continue;
        }


        fwrite(&a, sizeof(Artist), 1, fp);
    }

    fclose(fp);
    printf("\nSemua data berhasil disimpan ke file.\n");
}


RoastType artistToRoast(char nama[]) {
    if (strcmp(nama, "Taylor Swift") == 0) return ROAST_SAD;
    if (strcmp(nama, "Hindia") == 0) return ROAST_SAD;
    if (strcmp(nama, "Billie Eilish") == 0) return ROAST_SAD;
    if (strcmp(nama, "Juicy Lucy") == 0) return ROAST_SAD;
    if (strcmp(nama, "NIKI") == 0) return ROAST_SAD;
    if (strcmp(nama, "SZA") == 0) return ROAST_SAD;

    if (strcmp(nama, "Sabrina Carpenter") == 0) return ROAST_PERFORMATIVE;
    if (strcmp(nama, "Ariana Grande") == 0) return ROAST_PERFORMATIVE;
    if (strcmp(nama, "ILLIT") == 0) return ROAST_PERFORMATIVE;

    if (strcmp(nama, "The Weeknd") == 0) return ROAST_PLAYER;
    if (strcmp(nama, "Bruno Mars") == 0) return ROAST_PLAYER;

    if (strcmp(nama, "BLACKPINK") == 0) return ROAST_STARBOY;
    if (strcmp(nama, "LE SSERAFIM") == 0) return ROAST_STARBOY;

    if (strcmp(nama, "Tyler, The Creator") == 0) return ROAST_SKENA;
    if (strcmp(nama, "Arctic Monkeys") == 0) return ROAST_SKENA;

    if (strcmp(nama, "Sheila on 7") == 0) return ROAST_NORMIE;

    return ROAST_COUNT;
}

RoastType genreToRoast(char genre[]) {
    if (strcmp(genre, "Pop") == 0) return ROAST_NORMIE;
    if (strcmp(genre, "Rap") == 0) return ROAST_PLAYER;
    if (strcmp(genre, "Rock") == 0) return ROAST_EDGY;
    if (strcmp(genre, "Metal") == 0) return ROAST_EDGY;
    if (strcmp(genre, "EDM") == 0) return ROAST_STARBOY;
    if (strcmp(genre, "Jazz") == 0) return ROAST_SKENA;
    if (strcmp(genre, "Indie") == 0) return ROAST_SAD;
    if (strcmp(genre, "OST") == 0) return ROAST_DELUSIONAL;

    return ROAST_NORMIE;
}

void hitungRoastDariFile(RoastScore *score) {
    FILE *fp;
    Artist a;
    RoastType r;
    int i;

    for (i = 0; i < ROAST_COUNT; i++)
        score->point[i] = 0;

    fp = fopen("artist.dat", "rb");
    if (fp == NULL) {
        printf("Belum ada data artist.\n");
        return;
    }

    while (fread(&a, sizeof(Artist), 1, fp)) {
        r = artistToRoast(a.nama);
        if (r == ROAST_COUNT)
            r = genreToRoast(a.genre);

        score->point[r]++;
    }

    fclose(fp);
}

int main() {
    int pilihan;

    do {
        printf("\n+--------------------------------------+\n");
        printf("|            ROASTIFY v1.0             |\n");
        printf("| Lets see how bad is your music taste |\n");
        printf("|--------------------------------------|\n");
        printf("| 1. Input Data Artist                 |\n");
        printf("| 2. Tampilkan Semua Data Artist       |\n");
        printf("| 3. Rank Berdasarkan Waktu            |\n");
        printf("| 4. Deteksi fake fan                  |\n");
        printf("| 5. Leaderboard Artist                |\n");
        printf("| 6. Roast Selera Saya                 |\n");
        printf("| 7. Simpan Data                       |\n");
        printf("| 8. Keluar                            |\n");
        printf("+--------------------------------------+\n");

        printf("Pilih menu > ");
        scanf("%d", &pilihan);

        switch (pilihan) {
            case 1:
                inputDanSimpan();
                break;
            case 8:
                printf("Keluar dari program...\n");
                break;
            default:
                printf("Menu belum tersedia.\n");
        }

    } while (pilihan != 8);

    return 0;
}


